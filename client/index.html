<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <script src="/socket.io/socket.io.js"></script>
    <script src="common/js/Class.js"></script>
    <script src="common/js/ClientCommand.js"></script>
    <script src="js/MultiDirectionControl.js"></script>    
    <link rel="stylesheet" href="css/client.css" />
    <script>
       
        var SERVER = 'http://22.155.0.3:8000';
        var CMD_ID = 'cmd-client';
        var CMD_UP = ClientCommand.STOP;
        var CMD_DOWN = ClientCommand.START;
        var touchPad = null;

        function onload()
    	{			
            touchPad = document.getElementById('touchPad');
            control = new MultiDirectionControl(touchPad);

            socket = io.connect(SERVER);
            socket.on("connect", function() { 
                socket.emit("id", "client");
             });

            socket.on(ClientCommand.HAND_SHAKE, function(color) { 
                control.setColor(color);
            });
            
            control.addEventListener(MultiDirectionControl.TOUCH_START, function() { 
                send({cmd:CMD_DOWN}); 
            });

            control.addEventListener(MultiDirectionControl.TOUCH_END, function() { 
                send({cmd:CMD_UP});
            })    
             
            control.addEventListener(MultiDirectionControl.CHANGE, function(cx, cy) { 
                console.log(cx, cy);
            })              
        }			

    	function send(data)
    	{
    	    socket.emit(CMD_ID, data);
    	}

    </script>		
	</head>
    <body onload="onload();">
        <div id="container">
            <div id="touchPad"></div>
        </div>
    </body>
</html>
