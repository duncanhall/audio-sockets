<html>
	<head>
	<script src="/socket.io/socket.io.js"></script>
	<script src="js/Class.js"></script>
	<script>

	var output = null;
	var socket = null;
	var reactor = null;

	function onload()
	{     

		output = document.getElementById('output');
		socket = io.connect('http://22.155.0.3:8000');
		clients = [];

		socket.on("connect", function() {

			socket.emit("id", "slave");

		});

		socket.on("cmd-client", function(data) {

			var delim = data.indexOf(":");
			var id = data.substr(0, delim);
			var body = data.substr(delim + 1);
			var client = getClientByID(id);

			switch(body)
			{

				case "down":
					client.className = 'responder grow';
					break;

				case "up":
					client.className = 'responder';
					break;

				case "disconnect":
					destroyClient(id);
					break;
			}


		});

	}     

	function getClientByID (id) 
	{
		var responder = clients[id];
		if (responder == null)
		{
			responder = createClientResponder();
			clients[id] = responder;
		}
		return responder;
	}

	function destroyClient(id)
	{
		var responder = clients[id];

		if (responder != null)
		{
			output.removeChild(responder);
		}

		clients[id] = null;
		delete clients[id];
	}

	function createClientResponder ()
	{
		var responder = document.createElement('div');
		responder.className = 'responder';
		output.appendChild(responder);
		responder.style.marginLeft = String(clients.length * 200) + "px";

		return responder;
	}	

	</script>
	<link rel="stylesheet" href="css/slave.css" />

	</head>
	<body onload="onload();">
		<div id="output"></div>
	</body>
</html>
