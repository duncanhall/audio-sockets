<html>
	<head>
	<script src="/socket.io/socket.io.js"></script>
	<script src="js/slave.min.js"></script>
	<script>

	var output = null;
	var socket = null;
	var colors = [];
	var minX = 0;
	var maxX = 0;
	var minY = 0;
	var maxY = 0;

	var clients = new ClientController();
	var audio = new AudioController(clients.clients);
	var renderer = new Renderer(clients.clients);

	function onload()
	{     
		output = document.getElementById('output');
		socket = io.connect('http://22.155.0.2:8000');

		setBounds();
		window.onresize = setBounds;

		socket.on("connect", function() {
			socket.emit("id", "slave");
		});

		socket.on("cmd-client", function(data) {

			var id = data.id;
			var cmd = data.cmd;

			switch(cmd)
			{

				case ClientCommand.HAND_SHAKE:
					instrument = clients.add(output, id, data.color);
					colors[id] = data.color;
					break;

				case ClientCommand.START:
					if (!clients.hasActiveClients())
					{
						//renderer.start();
						audio.start();
					}

					clients.execute(id, ClientController.START);
					break;

				case ClientCommand.STOP:
					clients.execute(id, ClientController.STOP);

					if (!clients.hasActiveClients())
					{
						//renderer.stop();
						audio.stop();
					}					
					break;					

				case ClientCommand.CHANGE:
					clients.execute(id, ClientController.CHANGE, data);
					break;

				case ClientCommand.DISCONNECT:
					clients.destroy(id);
					break;
			}
		});
	}    	

	function setBounds(event) {

		minX = ((window.innerWidth / 2) * -1);
		maxX = (window.innerWidth / 2) - 50;
		minY = ((window.innerHeight / 2 ) * -1) + 50;
		maxY = (window.innerHeight / 2);		
	}

	</script>
	<link rel="stylesheet" href="css/slave.css" />

	</head>
	<body onload="onload();">
			<div id="output"></div>
	</body>
</html>
